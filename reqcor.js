!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).Apxor=t()}(this,(function(){"use strict";function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function t(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?e(Object(r),!0).forEach((function(e){s(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t,n){return(t=d(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,s,a=[],u=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(a.push(r.value),a.length!==t);u=!0);}catch(e){c=!0,i=e}finally{try{if(!u&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw i}}return a}}(e,t)||c(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||c(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function d(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var g={enable:!0,api_root:"https://server.apxor.com/v2/api",auto_track_events:["click","submit"],cookie_expiration:730,name:"",domain:"",cookie_prefix:"_apx_",idle_time_out:1800,ed_t_time:-1,sct_time:108e5,events:{stop:[],action:[]}},f={debug:!1,honorDNT:!1,idle_time_out:1800,client_id:null,session_id:null,plugins:[],version:"ALL",events_upload_time:-1,retry_time:-1,bulk_upload:!0},h="Opera Mini",v="Opera",p="BlackBerry",_="Internet Explorer Mobile",m="Microsoft Edge",S="Facebook Mobile",b="Chrome",w="Chrome iOS",y="UC Browser",x="Firefox iOS",C="Mobile Safari",E="Safari",T="Android Mobile",I="Konqueror",O="Firefox",A="Internet Explorer",k="Mozilla",L="Brave",D=o((function e(){r(this,e)}));s(D,"isCookieAvailable",(function(){try{var e=(new Date).getTime()+864e5;document.cookie="cookie_set=cookie_value; expires="+e;for(var t=document.cookie.split(";"),n=0;n<t.length;n++){if(-1!==t[n].indexOf("cookie_set"))return document.cookie="cookie_set=cookie_value; expires=Thu, 01 Jan 1970 00:00:01 GMT;",!0}return!1}catch(e){return!1}})),s(D,"get",(function(e){if(window.document)for(var t=e+"=",n=window.document.cookie.split(";"),r=0;r<n.length;r++){for(var i=n[r];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(t))return decodeURIComponent(i.substring(t.length,i.length))}return null}));var P,N,B,K,V=function(e){return void 0===e},M=function(e){return null===e},R=function(e){return void 0!==e&&!M(e)},U=function(e){return!R(e)},J=function(e){return"function"==typeof e},Y=function(e){return"string"==typeof e},q=function(e){return"boolean"==typeof e},j=function(e){return R(e)&&!M(e)&&!isNaN(e)},F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return null};J(t)&&(e.removeEventListener("pagehide",t),e.removeEventListener("beforeunload",t),e.removeEventListener("onunload",t))},G=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];J(e.addEventListener)?e.addEventListener(t,n,r):J(e.attachEvent)?e.attachEvent(t,n):e["on"+t]=n},X=function(e,t,n){J(e.removeEventListener)?e.removeEventListener(t,n):J(e.detachEvent)?e.detachEvent(t,n):e["on"+t]=n},z=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=function(e){return e<10?"0"+e:e},r=e.getFullYear()+"-"+n(e.getMonth()+1)+"-"+n(e.getDate())+"T"+n(e.getHours())+":"+n(e.getMinutes())+":"+n(e.getSeconds());return t?r+e.toTimeString().split(" ")[1].replace(/GMT([+|-])(\d{2})(\d{2})/,"$1$2:$3"):r},W=function(){return Date.now()},H=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e)},Q=function(){var e=window.navigator,t=(void 0===e?{}:e).userAgent,n=void 0===t?"":t;switch(!0){case/Windows Phone/i.test(n)||/WPDesktop/.test(n):return"Windows Phone";case/iPad/.test(n):return"iPad";case/iPod/.test(n):return"iPod Touch";case/iPhone/.test(n):return"iPhone";case/(BlackBerry|PlayBook|BB10)/i.test(n):return"BlackBerry";case/Android/.test(n):return"Android";default:return"Desktop"}},Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.navigator,r=void 0===n?{}:n,i=r.userAgent,o=void 0===i?"":i,a=r.vendor,u=void 0===a?"":a,c=h,l=v,d=p,g=_,f=m,D=S,P=b,N=w,B=y,K=x,V=C,M=E,R=T,U=I,J=O,Y=A,q=k,j=L,F=function(){var e;if(null!==(e=navigator)&&void 0!==e&&e.brave)return j;switch(!0){case o.includes(" OPR/"):return o.includes("Mini")?c:l;case/(BlackBerry|PlayBook|BB10)/i.test(o):return d;case o.includes("IEMobile")||o.includes("WPDesktop"):return g;case o.includes("FBIOS"):return D;case o.includes("Chrome"):return P;case o.includes("CriOS"):return N;case o.includes("Edge"):return f;case o.includes("UCWEB")||o.includes("UCBrowser"):return B;case o.includes("FxiOS"):return K;case u.includes("Apple"):return o.includes("Mobile")?V:M;case o.includes("Android"):return R;case o.includes("Konqueror"):return U;case o.includes("Firefox"):return J;case o.includes("MSIE")||o.includes("Trident/"):return Y;case o.includes("Gecko"):return q;default:return""}},G=F(),X=function(){var e,t=(e={},s(e,g,/rv:(\d+(\.\d+)?)/),s(e,f,/Edge\/(\d+(\.\d+)?)/),s(e,P,/Chrome\/(\d+(\.\d+)?)/),s(e,N,/CriOS\/(\d+(\.\d+)?)/),s(e,B,/(UCBrowser|UCWEB)\/(\d+(\.\d+)?)/),s(e,M,/Version\/(\d+(\.\d+)?)/),s(e,V,/Version\/(\d+(\.\d+)?)/),s(e,l,/(Opera|OPR)\/(\d+(\.\d+)?)/),s(e,J,/Firefox\/(\d+(\.\d+)?)/),s(e,K,/FxiOS\/(\d+(\.\d+)?)/),s(e,U,/Konqueror:(\d+(\.\d+)?)/),s(e,d,/BlackBerry (\d+(\.\d+)?)/),s(e,R,/android\s(\d+(\.\d+)?)/),s(e,Y,/(rv:|MSIE )(\d+(\.\d+)?)/),s(e,q,/rv:(\d+(\.\d+)?)/),e)[G];if(void 0===t)return null;var n=o.match(t);return n?parseFloat(n[n.length-2]):null},z=function(){switch(!0){case/Windows/i.test(o):return/Phone/.test(o)||/WPDesktop/.test(o)?"Windows Phone":"Windows";case/(iPhone|iPad|iPod)/.test(o):return"iOS";case/Android/.test(o):return"Android";case/(BlackBerry|PlayBook|BB10)/i.test(o):return"BlackBerry";case/Mac/i.test(o):return"Mac OS X";case/Linux/.test(o):return"Linux";case/CrOS/.test(o):return"Chrome OS";default:return""}},W=function(){var t=e.screen,n=void 0===t?{width:0,height:0}:t,r=n.height,i=n.width,o=e.devicePixelRatio,s=void 0===o?1:o,a=function(e){var t=Math.round(e)*s,n=t%10;return t+(n>0?10:0)-n};return{dimensions:{width:i,height:r},dimensions_in_pixels:{width:a(i),height:a(r)},dpi:s.toString()}},H=X(),Z=Q(),$=z();return t(t({},W()),{},{device:Z,browser_version:H,browser:G,os:$})},$=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.navigator,i=void 0===r?{}:r,o=i.language,a=n.browser_version,u=n.browser,c=D.isCookieAvailable();return s(e={},"apx_browser",u),s(e,"apx_browser_version",u+"_"+a),s(e,"apx_language",o),s(e,"apx_cookies_supported",c),e},ee=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.navigator,n=void 0===t?{}:t,r=n.connection,i=void 0===r?{}:r,o=i.effectiveType,s=i.saveData,a=n.platform,u=n.webdriver,c=e.document.referrer,l={};o&&(l.apx_network=o),s&&(l.apx_data_save_mode=s),a&&(l.apx_platform=a),R(u)&&u&&(l.apx_automation=u),R(c)&&c.length>0?l.apx_referrer=c:l.apx_referrer="direct";var d=Q();return l.apx_device_type=d,l},te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.navigator){var t=e.navigator.doNotTrack;return!("1"===t||"yes"===t)}return!0},ne=function(e){var t=e.document.querySelector("title");return R(t)&&R(t.innerText)?t.innerText:"Unknown"},re=function(e){return j(e)?ie(e/1e3):e},ie=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(!j(e)||!j(t))return e;if(t%1!=0)return e;var n=Math.pow(10,t);return Math.round(e*n)/n},oe=function(e){return e instanceof Object},se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(oe(e)){var r={};return Object.keys(t({},e)).forEach((function(t){var i=e[t],o=t;Y(t)||(o=JSON.stringify(t)),q(i)||j(i)?ce(r,o,i):Y(i)?r[o]=le(i):Array.isArray(i)?ae(r,o,i,n):oe(i)&&ue(r,t,i,n-1)})),r}return{}},ae=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(r<=0)ce(e,t,JSON.stringify(n));else if(Array.isArray(n)){var i=n;if(i.length>0){var o="";q(i[0])?o="b":Y(i[0])?o="s":j(i[0])?o="n":Array.isArray(i[0])?o="a":oe(i[0])&&(o="o");var s=i.length;if(""===o)return void ce(e,t,JSON.stringify(n));for(var a=1;a<s;a++)if("s"===o){if(!Y(i[a]))return void ce(e,t,JSON.stringify(n))}else if("b"===o){if(!q(i[a]))return void ce(e,t,JSON.stringify(n))}else if("n"===o){if(!j(i[a]))return void ce(e,t,JSON.stringify(n))}else if("a"===o){if(!Array.isArray(i[a]))return void ce(e,t,JSON.stringify(n))}else if("o"===o&&!oe(i[a]))return void ce(e,t,JSON.stringify(n));if("o"===o)if(r-1<=0){for(var u=[],c=0;c<s;c++)u.push(JSON.stringify(i[c]));ce(e,t,u)}else for(var l=0;l<s;l++)ue(e,t,i[l],r-1);else if("a"===o)for(var d=0;d<s;d++)ce(e,t,JSON.stringify(i[d]));else for(var g=0;g<s;g++)ce(e,t,i[g])}else ce(e,t,[])}},ue=function e(n,r,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;o<=0?ce(n,r,JSON.stringify(i)):Object.keys(t({},i)).forEach((function(t){var s=r+"_"+t,a=i[t];R(a)&&(Array.isArray(a)?ae(n,s,a,o-1):oe(a)?e(n,s,a,o-1):ce(n,s,a))}))},ce=function(e,t,n){if(R(t)&&R(n))if(e[t]){var r=e[t],i=r;Array.isArray(r)||((j(r)&&!j(n)||q(r)&&!q(n)||Y(r)&&!Y(n)||oe(r)&&!oe(n))&&(Y(r)||(r=JSON.stringify(r)),Y(n)||(n=JSON.stringify(n))),(i=[]).push(r)),i.push(n),e[t]=i}else e[t]=n},le=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:120;return Y(e)?e.length>t?e.slice(0,t)+"...":e:void 0},de=function(e){if(!R(e)&&!Y(e))return null;if("object"===n(e)||oe(e))return e;var t=e.replace(/(?:\r\n|\r|\n)/g,"").trim();try{return JSON.parse(t)}catch(e){}return null},ge=function(e,t){return R(t)?function(e){var t,n,r,i,o,s,a,u,c=0,l="";if(!e)return e;do{t=e[c++],n=e[c++],r=e[c++],i=(a=t<<16|n<<8|r)>>12&63,o=a>>6&63,s=63&a,l+=he.charAt(a>>18&63)+he.charAt(i)+he.charAt(o)+he.charAt(s)}while(c<e.length);return((u=e.length%3)?l.slice(0,u-3):l)+"===".slice(u||3)}(t=function(e,t){return Array.from(t).map((function(t,n){return t.charCodeAt(0)^ve(e,n)}))}(e,t)):null},fe=function(e,t){return function(e,t){return Array.from(t).map((function(t,n){return String.fromCharCode(t^ve(e,n))})).join("")}(e,t=function(e){var t,n,r,i,o,s,a,u,c=0,l=[];if(!e)return e;e+="";do{i=he.indexOf(e.charAt(c++)),o=he.indexOf(e.charAt(c++)),s=he.indexOf(e.charAt(c++)),a=he.indexOf(e.charAt(c++)),t=(u=i<<18|o<<12|s<<6|a)>>16&255,n=u>>8&255,r=255&u,l.push(t),64!==s&&(l.push(n),64!==a&&l.push(r))}while(c<e.length);return l}(t))},he="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ve(e,t){return e.charCodeAt(Math.floor(t%e.length))}function pe(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return t}function _e(e){for(var t="",n=new Uint8Array(e),r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t}String.prototype.includes||(String.prototype.includes=function(){return-1!==String.prototype.indexOf.apply(this,arguments)}),Array.from||(Array.from=(P=Object.prototype.toString,N=function(e){return"function"==typeof e||"[object Function]"===P.call(e)},B=Math.pow(2,53)-1,K=function(e){var t=function(e){var t=Number(e);return isNaN(t)?0:0!==t&&isFinite(t)?(t>0?1:-1)*Math.floor(Math.abs(t)):t}(e);return Math.min(Math.max(t,0),B)},function(e){var t=this,n=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var r,i=arguments.length>1?arguments[1]:void 0;if(void 0!==i){if(!N(i))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(r=arguments[2])}for(var o,s=K(n.length),a=N(t)?Object(new t(s)):new Array(s),u=0;u<s;)o=n[u],a[u]=i?void 0===r?i(o,u):i.call(r,o,u):o,u+=1;return a.length=s,a})),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),r=n.length>>>0;if(0===r)return!1;var i,o,s=0|t,a=Math.max(s>=0?s:r-Math.abs(s),0);for(;a<r;){if((i=n[a])===(o=e)||"number"==typeof i&&"number"==typeof o&&isNaN(i)&&isNaN(o))return!0;a++}return!1}});var me,Se=function(){var e=new Date;return e.getMonth()+"/"+e.getDate()+"/"+e.getFullYear()},be=function(){var e=new Date;return{hours:e.getHours(),mins:e.getMinutes()}},we=["log","debug","info","warn","error"],ye=we.reduce((function(e,t){return e[t]=t,e}),{}),xe=function(e){if(V(e)){var t=function(){return null};e=we.reduce((function(e,n){return e[n]=t,e}),{})}return e},Ce=function(){function e(){r(this,e)}return o(e,null,[{key:"enabled",set:function(t){e._enabled=t}},{key:"level",set:function(t){e._level=t}},{key:"console",set:function(t){e._console=xe(t)}}]),e}();function Ee(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function Te(e,t,n,r,i,o){return Ee((s=Ee(Ee(t,e),Ee(r,o)))<<(a=i)|s>>>32-a,n);var s,a}function Ie(e,t,n,r,i,o,s){return Te(t&n|~t&r,e,t,i,o,s)}function Oe(e,t,n,r,i,o,s){return Te(t&r|n&~r,e,t,i,o,s)}function Ae(e,t,n,r,i,o,s){return Te(t^n^r,e,t,i,o,s)}function ke(e,t,n,r,i,o,s){return Te(n^(t|~r),e,t,i,o,s)}function Le(e,t){var n,r,i,o,s;e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var a=1732584193,u=-271733879,c=-1732584194,l=271733878;for(n=0;n<e.length;n+=16)r=a,i=u,o=c,s=l,a=Ie(a,u,c,l,e[n],7,-680876936),l=Ie(l,a,u,c,e[n+1],12,-389564586),c=Ie(c,l,a,u,e[n+2],17,606105819),u=Ie(u,c,l,a,e[n+3],22,-1044525330),a=Ie(a,u,c,l,e[n+4],7,-176418897),l=Ie(l,a,u,c,e[n+5],12,1200080426),c=Ie(c,l,a,u,e[n+6],17,-1473231341),u=Ie(u,c,l,a,e[n+7],22,-45705983),a=Ie(a,u,c,l,e[n+8],7,1770035416),l=Ie(l,a,u,c,e[n+9],12,-1958414417),c=Ie(c,l,a,u,e[n+10],17,-42063),u=Ie(u,c,l,a,e[n+11],22,-1990404162),a=Ie(a,u,c,l,e[n+12],7,1804603682),l=Ie(l,a,u,c,e[n+13],12,-40341101),c=Ie(c,l,a,u,e[n+14],17,-1502002290),a=Oe(a,u=Ie(u,c,l,a,e[n+15],22,1236535329),c,l,e[n+1],5,-165796510),l=Oe(l,a,u,c,e[n+6],9,-1069501632),c=Oe(c,l,a,u,e[n+11],14,643717713),u=Oe(u,c,l,a,e[n],20,-373897302),a=Oe(a,u,c,l,e[n+5],5,-701558691),l=Oe(l,a,u,c,e[n+10],9,38016083),c=Oe(c,l,a,u,e[n+15],14,-660478335),u=Oe(u,c,l,a,e[n+4],20,-405537848),a=Oe(a,u,c,l,e[n+9],5,568446438),l=Oe(l,a,u,c,e[n+14],9,-1019803690),c=Oe(c,l,a,u,e[n+3],14,-187363961),u=Oe(u,c,l,a,e[n+8],20,1163531501),a=Oe(a,u,c,l,e[n+13],5,-1444681467),l=Oe(l,a,u,c,e[n+2],9,-51403784),c=Oe(c,l,a,u,e[n+7],14,1735328473),a=Ae(a,u=Oe(u,c,l,a,e[n+12],20,-1926607734),c,l,e[n+5],4,-378558),l=Ae(l,a,u,c,e[n+8],11,-2022574463),c=Ae(c,l,a,u,e[n+11],16,1839030562),u=Ae(u,c,l,a,e[n+14],23,-35309556),a=Ae(a,u,c,l,e[n+1],4,-1530992060),l=Ae(l,a,u,c,e[n+4],11,1272893353),c=Ae(c,l,a,u,e[n+7],16,-155497632),u=Ae(u,c,l,a,e[n+10],23,-1094730640),a=Ae(a,u,c,l,e[n+13],4,681279174),l=Ae(l,a,u,c,e[n],11,-358537222),c=Ae(c,l,a,u,e[n+3],16,-722521979),u=Ae(u,c,l,a,e[n+6],23,76029189),a=Ae(a,u,c,l,e[n+9],4,-640364487),l=Ae(l,a,u,c,e[n+12],11,-421815835),c=Ae(c,l,a,u,e[n+15],16,530742520),a=ke(a,u=Ae(u,c,l,a,e[n+2],23,-995338651),c,l,e[n],6,-198630844),l=ke(l,a,u,c,e[n+7],10,1126891415),c=ke(c,l,a,u,e[n+14],15,-1416354905),u=ke(u,c,l,a,e[n+5],21,-57434055),a=ke(a,u,c,l,e[n+12],6,1700485571),l=ke(l,a,u,c,e[n+3],10,-1894986606),c=ke(c,l,a,u,e[n+10],15,-1051523),u=ke(u,c,l,a,e[n+1],21,-2054922799),a=ke(a,u,c,l,e[n+8],6,1873313359),l=ke(l,a,u,c,e[n+15],10,-30611744),c=ke(c,l,a,u,e[n+6],15,-1560198380),u=ke(u,c,l,a,e[n+13],21,1309151649),a=ke(a,u,c,l,e[n+4],6,-145523070),l=ke(l,a,u,c,e[n+11],10,-1120210379),c=ke(c,l,a,u,e[n+2],15,718787259),u=ke(u,c,l,a,e[n+9],21,-343485551),a=Ee(a,r),u=Ee(u,i),c=Ee(c,o),l=Ee(l,s);return[a,u,c,l]}function De(e){var t,n="",r=32*e.length;for(t=0;t<r;t+=8)n+=String.fromCharCode(e[t>>5]>>>t%32&255);return n}function Pe(e){var t,n=[];for(n[(e.length>>2)-1]=void 0,t=0;t<n.length;t+=1)n[t]=0;var r=8*e.length;for(t=0;t<r;t+=8)n[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return n}function Ne(e){var t,n,r="";for(n=0;n<e.length;n+=1)t=e.charCodeAt(n),r+="0123456789abcdef".charAt(t>>>4&15)+"0123456789abcdef".charAt(15&t);return r}function Be(e){return unescape(encodeURIComponent(e))}function Ke(e){return function(e){return De(Le(Pe(e),8*e.length))}(Be(e))}function Ve(e,t){return function(e,t){var n,r,i=Pe(e),o=[],s=[];for(o[15]=s[15]=void 0,i.length>16&&(i=Le(i,8*e.length)),n=0;n<16;n+=1)o[n]=909522486^i[n],s[n]=1549556828^i[n];return r=Le(o.concat(Pe(t)),512+8*t.length),De(Le(s.concat(r),640))}(Be(e),Be(t))}me=Ce,s(Ce,"_console",xe()),s(Ce,"_enabled",!1),s(Ce,"_level","error"),s(Ce,"_render",(function(e){return function(){var t=we.indexOf(e)>=we.indexOf(me._level);if(me._enabled&&t){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];me._console[e].apply(me._console,r)}}})),s(Ce,"log",me._render(ye.log)),s(Ce,"info",me._render(ye.info)),s(Ce,"debug",me._render(ye.debug)),s(Ce,"warn",me._render(ye.warn)),s(Ce,"error",me._render(ye.error));var Me=function(e,t,n){return t?n?Ve(t,e):Ne(Ve(t,e)):n?Ke(e):Ne(Ke(e))},Re=o((function e(){var t=this;r(this,e),s(this,"STjz",(function(e,n){if(t._listeners[e])for(var r=t._listeners[e],i=0;i<r.length;i++){(0,r[i])(n)}})),s(this,"registerForEvent",(function(e,n){var r;J(n)&&((r=t._listeners[e]?t._listeners[e]:[]).push(n),t._listeners[e]=r)})),s(this,"unregisterFromEvent",(function(e,n){if(t._listeners[e]){for(var r=t._listeners[e],i=[],o=0;o<r.length;o++){var s=r[o];s!==n&&i.push(s)}t._listeners[e]=i}})),s(this,"jPdX",(function(){t._listeners={}})),this._listeners={}})),Ue=function(e,t){return{name:"visible"===e?"FOREGROUND":"BACKGROUND",time:j(t)?ie(t):0}},Je=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(Y(e)&&oe(t))return{name:e,additional_info:t,category:R(n)&&Y(n)?n:void 0,time:j(r)?ie(r):0}},Ye=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return{navigation_id:e,name:t,duration:j(n)?ie(n):0,transition_time:j(r)?ie(r):0}},qe={navigation_events:[],app_events:[],system_events:[],user_events:[],chunk_attributes:{},user_attributes:{},session_attributes:{}},je=function(e){return{sdk_version:232,config_id:"apx",tick_interval:1,chunk_retry_window:1800,sdk_start_time:e}},Fe=function(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Ce.debug("Model : Building the initial state of the Chunk"),{sdk_info:je(e),session_info:{id:r,launch_time:n,launch_time_string:z(new Date(n)),startup_time:0,is_background:!1,is_first_session:!1,duration:0,total_duration:0,process_name:"",is_fatal:!1,launch_type:"normal"},app_info:{app_name:"",app_version:"ALL",bundle_id:"",installation_time:ot.getInstance().getInstallationTime(W()),app_mode:"production"},device_info:Z(window),chunk_meta:{id:r+":"+i,number:i,reporting_times:[]},chunk_details:t(t({},qe),{},{user_attributes:{},session_attributes:{}})}},Ge=o((function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e),s(this,"rzsG",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=t.window.XMLHttpRequest;Ce.debug("Request : POST request with data"),s?t.UMGq(e,n,r,i,o):(Ce.error("Request : Unknown browser"),r(403,"Unknown")),Ce.debug("Request : Sent request to server")})),s(this,"get",(function(e,n){var r=t.window,i=r.fetch,o=r.XMLHttpRequest;if(i)i(e).then((function(e){try{if(e.ok)return e.json()}catch(e){Ce.debug("Request : Error while parsing the response ".concat(e))}return null})).then((function(e){R(e)?n(200,e):(Ce.error("Request : API request failed. ".concat(JSON.stringify(e))),n(500,{}))})).catch((function(e){Ce.error("Request : API request failed. ".concat(e)),n(500,e)}));else if(o){var s=new o;s.open("GET",e,!0),s.onreadystatechange=function(){4===s.readyState&&n(s.status,s.responseText)},s.send()}else Ce.error("Request : Unknown browser"),n(403,"Unknown");Ce.debug("Request : sent request to server")})),s(this,"UMGq",(function(e,n,r,i,o){var s=new XMLHttpRequest;s.onerror=function(e){Ce.error("Request : API request failed. ".concat(e)),r(500,null)},s.open("POST",e,o),s.setRequestHeader("Content-Type","application/json; charset=UTF-8"),Object.keys(null!=i?i:{}).forEach((function(e){s.setRequestHeader(e,i[e])})),s.onreadystatechange=function(){if(4===s.readyState){var i=s.responseText,o=i.match(/Failed to execute 'send' on 'XMLHttpRequest'/);if(!(M(o)||V(o)||M(o[0])||V(o[0])||"Failed to execute 'send' on 'XMLHttpRequest'"!==o[0]))return void t.UMGq(e,n,r,!0);try{i=JSON.parse(i)}catch(e){Ce.debug("Request : Error while parsing the response ".concat(e))}r(s.status,i)}};try{s.send(JSON.stringify(n))}catch(e){Ce.error("Request : API request failed. ".concat(e)),r(500,e)}})),this.window=n})),Xe="/sdk/<app-id>/enabled-status?platform=web&version=232",ze=g.api_root,We=function(e,t){return ze+e.replace("<app-id>",t)},He=o((function e(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,e),s(this,"UeeO",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return null},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return null};return function(n,r){Ce.debug("XHR Response: [".concat(n,"]")),n<400?r&&"APXOR_STATUS_SUCCESS"===r.apxor_status?r.details?e(r.details):e(r):200===n?e(r):t(n,r):t&&J(t)&&t(n,r)}})),s(this,"ENPn",(function(e,t){n.makeGetRequest(n.sdkEnabledStatusAPI,e,t)})),s(this,"XDdn",(function(e,t){n.makeGetRequest(n.configAPI,e,t)})),s(this,"tRuf",(function(e,t,r){n.request.rzsG(n.userInfoAPI,e,n.UeeO(t,r),{})})),s(this,"YZZd",(function(e,t,r){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];Ce.debug("Posting chunk"),n.request.rzsG(n.chunksAPI,e,n.UeeO(t,r),{},i)})),s(this,"makeGetRequest",(function(e,t,r){n.request.get(e,n.UeeO(t,r))})),s(this,"makePostRequest",(function(e,t,r,i,o){n.request.rzsG(e,t,n.UeeO(i,o),r)})),this.request=new Ge(i),this.configAPI=We("/config/<app-id>/web",t),this.chunksAPI=We("/<app-id>/chunks",t),this.sdkEnabledStatusAPI=We(Xe,t),this.userInfoAPI=We("/user?appId=<app-id>",t)})),Qe=o((function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;r(this,e),s(this,"aLxk",-1),s(this,"bqGe",0),s(this,"NxnX",(function(){return t.bqGe})),s(this,"Fuzv",(function(){return t.aLxk})),s(this,"YolJ",(function(){t.aLxk=-1,t.bqGe=0})),s(this,"mpEh",(function(e){if("FOREGROUND"===e.name){if(-1!==t.aLxk){var n=Math.round(re(Date.now()-t.aLxk));t.bqGe+=n;var r=ot.getInstance().getFromStorage("_apx_sId");if(R(r)&&ot.getInstance().getSessionId()!==r){ot.getInstance().cqxf();var i=ot.getInstance().wlgU(),o=i.total_duration,s=i.duration;t.bqGe=o>s?o-s:0}}}else t.aLxk=Date.now(),ot.getInstance().persistToStorage("apx_lbgt",t.aLxk)})),ot.getInstance().registerForEvent("SYSTEM_EVENT",this._onSystemEvent),this.bqGe=n,ot.getInstance().persistToStorage("apx_lbgt",this.aLxk)})),Ze=function(){function e(t){var n=this;r(this,e),s(this,"AmPO",!1),s(this,"RXhJ",(function(e){var t=!0;try{window[e]?(window[e].setItem("_apx_","apx"),"apx"!==window[e].getItem("_apx_")&&(t=!1),window[e].removeItem("_apx_")):t=!1}catch(e){t=!1}return t||Ce.error("Storage : LocalStorage not supported"),t})),s(this,"rKkk",(function(e){Ce.error("".concat(n.storageType," Error: "),e)})),s(this,"get",(function(e){try{return n.storage.getItem(e)}catch(t){Ce.error("Storage : Error while getting the ".concat(e," from storage - ").concat(t))}return null})),s(this,"FUUt",(function(e){try{return JSON.parse(n.storage.getItem(e))}catch(t){Ce.error("Storage : Error while parsing ".concat(e,"'s value from storage - ").concat(t))}return null})),s(this,"set",(function(e,t){try{n.storage.setItem(e,t)}catch(t){Ce.error("Storage : Error while setting the ".concat(e,"'s value to storage - ").concat(t))}})),s(this,"ffsN",(function(e){try{n.storage.removeItem(e)}catch(t){Ce.error("Storage : Error while removing the ".concat(e," from storage - ").concat(t))}})),s(this,"clear",(function(){try{n.storage.removeItem("_apx_config"),n.storage.removeItem("_apx_ua"),n.storage.removeItem("_apx_lEt"),n.storage.removeItem("_apx_sId"),n.storage.removeItem("_apx_sc"),n.storage.removeItem("apx_id"),n.storage.removeItem("apx_in"),n.storage.removeItem("apx_ver"),n.storage.removeItem("apx_lbgt"),n.storage.removeItem("_apx_cd"),n.storage.removeItem("_apx_od"),n.storage.removeItem("_apx_lt_count"),n.storage.removeItem("_apx_use"),n.storage.removeItem("_apx_scnm"),n.storage.removeItem("_apx_lct"),n.storage.removeItem("_apx_ch"),n.storage.removeItem("_apx_lef"),n.storage.removeItem("_apx_ledt")}catch(e){Ce.error("Storage : Error while clearing the storage - ".concat(e))}})),this.AmPO=this.RXhJ(t),this.AmPO?(this.storage=window[t],this.storageType=t):(this.storageType=t,this.storage={length:0,getItem:function(){},setItem:function(){},removeItem:function(){},clear:function(){},get:function(){},set:function(){},remove:function(){},getParsed:function(){}})}return o(e,[{key:"isStorageAvailable",value:function(){return this.AmPO}}],[{key:"waitForBrowserStorage",value:function(t){var n=15,r=setInterval((function(){n--,e.isLocalStorageEnabled()||n<=0?(Ce.debug("Storage : Local storage available"),clearInterval(r),t()):Ce.debug("Storage : Local storage not available yet")}),100)}},{key:"isLocalStorageEnabled",value:function(){try{var e="__apx_storage_test__";window.localStorage.setItem(e,"test");var t=window.localStorage.getItem(e);return window.localStorage.removeItem(e),"test"===t}catch(e){return Ce.debug("Browser storage is not enabled yet : ".concat(e)),!1}}}]),e}();var $e=function(){function e(n){var i=this;r(this,e),s(this,"bVPX",""),s(this,"vaKi",(function(){var e,t=i.storage.get("_apx_config");if(R(t))try{t=JSON.parse(fe(i.bVPX,t))}catch(e){t=null}return null!==(e=t)&&void 0!==e?e:g})),s(this,"cxjV",(function(e){i.storage.set("_apx_config",ge(i.bVPX,JSON.stringify(e)))})),s(this,"FJkB",(function(e){i.storage.set("apx_id",e)})),s(this,"bQmJ",(function(){var e=null;try{e=i.storage.get("apx_id")}catch(e){Ce.debug("Datamaager : Can not get user id from storage-"+e)}return e})),s(this,"Xgvu",(function(e){return i.storage.set("apx_ver",e)})),s(this,"HtJL",(function(){var e=i.storage.get("apx_ver");if(!R(e)&&D.isCookieAvailable()){var t=D.get("apx_ver");if(R(t))return i.storage.set("apx_ver",t),t}return e})),s(this,"YFxR",(function(e,t){i.storage.set(e,t)})),s(this,"getItem",(function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=i.storage.get(e);if(t){var r=de(n);if(null===r)try{n=JSON.parse(fe(i.bVPX,n))}catch(t){Ce.debug("Datamanager : ".concat(e," - value not found in storage")),n=null}else n=r}return Ce.debug("Datamanager : ".concat(e,"'s value from storage is ").concat(JSON.stringify(n))),n})),s(this,"lUOb",(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=i.getItem(e,n);return R(r)?r:(Ce.debug("Datamanager : ".concat(e,"'s value is not defined. Returning default-").concat(JSON.stringify(t))),t)})),s(this,"vROQ",(function(){i.storage.clear()})),s(this,"resetUserProperties",(function(){Ce.debug("Datamanager : Removing the user attributes form the storage"),i.storage.ffsN("_apx_ua")})),s(this,"gaat",(function(e){Ce.debug("DataManager : Setting the installation time to ".concat(e)),i.storage.set("apx_in",e)})),s(this,"getInstallationTime",(function(e){var t=i.storage.get("apx_in");return R(t)?(Ce.debug("Datamanager : Stored installation time ".concat(t)),Number(t)):(Ce.debug("Datamanager : Stored installation time not found. Persisting and returning the default time ".concat(e)),i.gaat(e),e)})),s(this,"ntcu",(function(e){Ce.debug("Datamanager : Persisting the old session chunk to the storage"),i.storage.set("_apx_od",ge(i.bVPX,JSON.stringify(e)))})),s(this,"hNKQ",(function(){var e;Ce.debug("Datamanager : Getting the old session chunk details form the storage");var t=i.storage.get("_apx_od"),n=de(t);if(null===n)try{t=JSON.parse(fe(i.bVPX,t))}catch(e){t=null}else t=n;return null!==(e=t)&&void 0!==e?e:[]})),s(this,"waYN",(function(){Ce.debug("Datamanager : Removing the old session chunk details form the storage"),i.storage.ffsN("_apx_od")})),s(this,"LHHQ",(function(){return i.getItem("_apx_use",!0)})),s(this,"gBBO",(function(e){Ce.debug("Datamanager : Persisting the old session chunk details to the storage"),i.storage.set("_apx_use",ge(i.bVPX,JSON.stringify(e)))})),s(this,"sjOv",(function(){Ce.debug("Datamanager : Removing the old session chunk details form the storage"),i.storage.ffsN("_apx_use")})),s(this,"QxSn",(function(){Ce.debug("Datamanager : Getting the session chunknumber map");var e=i.getItem("_apx_scnm",!0);return R(e)||(e={}),e})),s(this,"FtMl",(function(e){Ce.debug("Datamanager : Persisting the new session chunknumber map");var t=ge(i.bVPX,JSON.stringify(e));i.YFxR("_apx_scnm",t)})),s(this,"TRXo",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now(),r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3600;Ce.debug("Datamanager : Creating a new chunk");var s,a=!1,u=Number(i.storage.get("_apx_lEt"))||0,c=Date.now(),l=Math.round(re(c-u)),d=i.blTE();if((l>o||U(d))&&(a=!0),a)Ce.debug("Datamanager : This is a new session. Creating a new chunk"),s=Fe(e,n,r);else{Ce.debug("Datamanager : This is an old session. Updating the existing chunk");var g=d.chunk_meta.number,f=d.session_info.id,h=g+1;(s=t({},d)).chunk_meta=t(t({},s.chunk_meta),{},{number:h,id:f+":"+h,reporting_times:[Date.now()]}),s.chunk_details=t({},qe)}return{is_new_session:a,chunk:s}})),s(this,"xRVx",(function(){Ce.debug("Datamanager : Current chunk removed from storage"),i.storage.ffsN("_apx_cd")})),s(this,"CmLN",(function(e){Ce.debug("Datamanager : Persisting the Current chunk to storage"),i.storage.set("_apx_cd",ge(i.bVPX,JSON.stringify(e)))})),s(this,"blTE",(function(){return i.getItem("_apx_cd",!0)})),this.bVPX=n,this.storage=new Ze("localStorage"),Ce.debug("DataManager : Initialized")}return o(e,[{key:"getltCount",value:function(e){try{var t=this.storage.get("_apx_lt_count");if(t){var n=fe(this.bVPX,t);return JSON.parse(n)[e.replace("'","").replace("â€™","")]}}catch(t){Ce.error("Datamanager : Error gettting the LT Count for the event -"+e)}return 0}},{key:"updateRetainedDayCount",value:function(e){Ce.debug("Datamanager : Re-calculating and updating the retention day");var t=this.getItem("apx_in"),n=Math.abs(t-e)/36e5,r=Math.floor(n/24);this.YFxR("apx_retained_days",r)}}]),e}(),et=["scroll","touchmove"],tt=o((function e(){var t=this,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];r(this,e),s(this,"FBXr",!0),s(this,"qLku",(function(){Ce.debug("Registering for System Event ","visibilitychange");var e=function(){var e=ot.getInstance(),n=e.getSDKRunningTimeInSec(),r="visible"===window.document.visibilityState,i=Ue(window.document.visibilityState,n);if(r?(e.ZeSt(!1),t.aLxk>-1&&(e.qdfK((function(){e.dispatchEvent("SYSTEM_EVENT",i)})),i.background_time=ie(re(Date.now()-t.aLxk)))):(e.ZeSt(!0),e.TRLL(),t.aLxk=Date.now(),e.dispatchEvent("SYSTEM_EVENT",i)),r){var o=e.getUserAttributes().apx_browser;!t.FBXr||-1!==o.indexOf("Mobile Safari")&&-1!==o.indexOf("Safari")||(t.FBXr=!1)}else e.UOPq()};G(document,"visibilitychange",e),t._handlers.push(t.LbiD("visibilitychange",e))})),s(this,"KcCt",(function(){t._handlers.forEach((function(e){var t=e.type,n=e.handler;Ce.debug("Unregistering from event type ",t),et.includes(t)?X(window.document,t,n):X(document,t,n)})),t._handlers=[],t._scrollEvents=[],t._scrollData={}})),s(this,"UVxV",(function(){return[]})),s(this,"LbiD",(function(e,t){return{type:e,handler:t}})),this.aLxk=-1,this._handlers=[],this._scrollEvents=[],this._scrollData={},this.FBXr=n,this.qLku()})),nt=o((function e(){var t=this;r(this,e),s(this,"Yyfr",!0),s(this,"bVPX",""),s(this,"initialize",(function(e,n){t.bVPX=n;var r=e.validate_hash,i=void 0===r||r,o=e.cs_ht_time,s=void 0===o?-1:o;t.Yyfr=i,t.configsHashThrottleTime=s,ot.getInstance().registerForEvent("APP_EVENT",(function(e){t.yIoY(e.name)}))})),s(this,"fetchConfiguration",(function(e,n,r,i){if(J(i))if(t.Yyfr){var o=ot.getInstance();if(t.configsHashThrottleTime>0){var s=o.XoEM(e+"_lcfht",-1);if(s>0)if(Math.abs(Date.now()-s)<t.configsHashThrottleTime)return void t.wBmx(e,i)}o.persistToStorage(e+"_lcfht",Date.now());var a=t.GWnb(),u={pid_mid:[]},c=a[e];if(R(c)){Array.isArray(c)||(c=[c]);var l=[];c.forEach((function(e){var t=e.pid+"_"+e.mid;l.includes(t)||l.push(t)})),l.length>0&&(u.pid_mid=l.join(","))}else c=[];var d=o.getUserAttributes().custom_user_id,g=void 0===d?null:d;g&&(n+="&customerId="+g),o.makePostRequest(n,u,{"Content-Type":"application/json"},(function(n){t.MnYo(n,e,r,{configs:c,syncData:a},i)}),(function(){Ce.error("Failed to fetch"),i(e,{configs:c})}))}else t.jBOQ(e,r,[],i)})),s(this,"GWnb",(function(){var e=ot.getInstance().getFromStorage("_apx_sc");return R(e)?JSON.parse((new TextDecoder).decode(pe(fe(ot.getInstance().getSiteId(),e)))):{}})),s(this,"wBmx",(function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=r;r||(i=t.GWnb());var o=i[e];R(o)&&(Array.isArray(o)||(o=[o]),Ce.debug("Reading from storage"),n(e,{configs:o}))})),s(this,"MnYo",(function(e,n,r,i,o){var s=e.pull,a=void 0===s?[]:s,u=e.drop,c=void 0===u?[]:u,l=i.configs,d=i.syncData,g=JSON.parse(ot.getInstance().getFromStorage("apx_termination_ID")),f=[];c.length>0||a.length>0?(l.forEach((function(e){c.includes(e.pid)||a.includes(e.pid)||f.push(e),c.includes(e.pid)&&null!==g&&null!=g&&g[e._id]&&(delete g[e._id],ot.getInstance().persistToStorage("apx_termination_ID",JSON.stringify(g)))})),d[n]=f,ot.getInstance().persistToStorage("_apx_sc",ge(t.bVPX,_e((new TextEncoder).encode(JSON.stringify(d)))))):(Ce.debug("Nothing to delete",n),f=l),a.length>0?(a.forEach((function(e){r+="&pids="+e})),t.jBOQ(n,r,f,o)):(Ce.debug("Nothing to pull",n),o(n,{configs:f}))})),s(this,"jBOQ",(function(e,n,r,i){ot.getInstance().makeGetRequest(n,(function(n){if(R(n.configs)&&Array.isArray(n.configs)&&0==n.configs.length)i("",{configs:[]});else if(R(n.configs)&&Array.isArray(n.configs)){var o=t.GWnb(),s=[].concat(u(r),u(n.configs));o[e]=s,ot.getInstance().persistToStorage("_apx_sc",ge(t.bVPX,_e((new TextEncoder).encode(JSON.stringify(o))))),i(e,{configs:s})}}),(function(){i(e,{configs:[]})}))})),s(this,"OfSJ",(function(e){t.yIoY(e)})),s(this,"yIoY",(function(e){var n=t.GWnb();if(R(n.d)||(n.d={}),JSON.stringify(n.d).length>2097152)Ce.error("Sync : Reached maximum limit. Can't store further");else{var r=0;R(n.d[e])&&(r=n.d[e]),r+=1,n.d[e]=r,ot.getInstance().persistToStorage("_apx_sc",ge(t.bVPX,_e((new TextEncoder).encode(JSON.stringify(n)))))}})),s(this,"getEventCount",(function(e){var n=t.GWnb();return R(n.d)&&R(n.d[e])?n.d[e]:0}))})),rt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(){Ce.error("".concat(e,": Apxor SDK not initialised."))}},it={reportChunkOnVisibilityChange:rt("TRLL"),logAppEvent:rt("WGuy"),logClientEvent:rt("logClientEvent"),logPageView:rt("logPageView"),setUserId:rt("setUserId"),setUserProperties:rt("setUserProperties"),setSessionProperties:rt("setSessionProperties"),setAppVersion:rt("setAppVersion"),getClientId:rt("getClientId"),getSessionId:rt("getSessionId"),startSession:rt("startSession"),endSession:rt("endSession"),flattenJSON:rt("flattenJSON"),setRedirectionHandler:rt("setRedirectionHandler"),setInitFlag:rt("setInitFlag")},ot=function(){function e(){var n=this;return r(this,e),s(this,"eBuu",{}),s(this,"TSLA",!1),s(this,"flnV",{}),s(this,"fDid",{}),s(this,"orOO",{}),s(this,"nyxV",{}),s(this,"CsTG",{}),s(this,"ZvIV",{}),s(this,"LnLo",{}),s(this,"GMjL",1),s(this,"cZWk",null),s(this,"MHYs",!1),s(this,"saPj",!1),s(this,"EBKC",{}),s(this,"JRyM",{}),s(this,"jpdV",{}),s(this,"whqq",{}),s(this,"VzVJ",3600),s(this,"cqnr",20),s(this,"SeAP",-1),s(this,"HuHq",2e4),s(this,"ZOmf",-1),s(this,"vIFz",10),s(this,"zspv",!1),s(this,"gYZO",!1),s(this,"DEse",-1),s(this,"dVtK",!1),s(this,"cXEP",!0),s(this,"clientEvents",[]),s(this,"vAjO",[]),s(this,"OTwG",[]),s(this,"oKMw",[]),s(this,"DfOO",{}),s(this,"Lhgu",0),s(this,"DDDY",null),s(this,"TmaA",null),s(this,"vJYe",null),s(this,"aoES",!1),s(this,"VEdb",!1),s(this,"MnXi",{}),s(this,"initWaitTime",1500),s(this,"version",""),s(this,"Oshz",""),s(this,"Idax",""),s(this,"sessionStartTime",null),s(this,"sessionId",""),s(this,"OoTk",{}),s(this,"BBEE",(function(e){var t=n.config.plugins;if(R(t)&&R(t.length))for(var r=0;r<t.length;r++){var i=t[r];try{var o;null===(o=window[i])||void 0===o||o.init(e),Ce.debug("Controller : Initialized plugin ".concat(i))}catch(e){Ce.error("Controller : Failed to initialize plugin ".concat(i," with error ").concat(e))}}})),s(this,"initialize",(function(e,t,r,i,o,s){if(!n.TSLA){var a=function(){Ce.debug("Controller : On Site enabled in config"),n.Zkcq(u,s)},u=function(e){n.Idax=e,Ce.debug("Controller : On config hash fetch"),n.QvKk(e,c)},c=function(){Ce.info("Controller : Waiting for resources completed"),n.CSOi(),n.myzW(),n.IHrU(),n.Oshz=n.fJhp(),n.ReDR(),n.PMAS(),n.mIVZ(),n.gtcj(),n.ryzv(),n.AhGg(),n.nODQ(),n.gVvJ(n.Idax);var e=n.fTax();n.jpdV=new Qe(e),n.FUlC(),n.qdfK(l)},l=function(){n.MHYs=!0,n.TSLA=!0;var e=n.cqxf();n.EBKC.CmLN(e),n.BBEE(d)},d=function(){var e,t;(n.OitU(n.window.document.visibilityState),n.newSession&&(n.sessionStartTime=Date.now(),n.WGuy("apx_app_opened",{time:z(new Date)}),n.GbTM()),n.logPageView(n.window.location.pathname),n.Pcpf(),n.Vgri(),o(),null!==(e=i.ApxorRTM)&&void 0!==e&&e.isBadgePresent)&&(null===(t=i.ApxorRTM)||void 0===t||t.badgesLists.forEach((function(e){var t;n.isBadgeTriggerSatisfied(e)&&!document.getElementById("apxor-badge-container-".concat("-".concat(e).replaceAll(" ","").replace(/[^\w\s]/gi,"")))&&(null===(t=i.ApxorRTM)||void 0===t||null===(t=t.ceInstance)||void 0===t||t.notifyEventListener(Je("apxor-badge-container-".concat("-".concat(e).replaceAll(" ","").replace(/[^\w\s]/gi,"")),{},void 0,n.getTimeElapsedInSession())))})))};n.NjOA((function(){Ce.debug("Controller : Wait for browser storage completed."),n.hvMQ(e,t,r,i),n.BhEP(),n.QYcY(),n.whqq.initialize(n.config,n.siteId),n.YKGx(a,s)}))}})),s(this,"getSiteId",(function(){return n.siteId})),s(this,"setRedirectionHandler",(function(e){n.TSLA?n.DDDY?n.DDDY=e:(n.DDDY=e,n.registerForEvent("CLIENT_EVENT",n.eOHm)):it.setRedirectionHandler()})),s(this,"eOHm",(function(e){e&&"REDIRECT"===e.name&&n.DDDY(e.additional_info.url)})),s(this,"makePostRequest",(function(e,t,r,i,o){n._api.makePostRequest(e,t,r,i,o)})),s(this,"getDevInfo",(function(){return n.fDid})),s(this,"getListOfEventsLogged",(function(){return n.MnXi})),s(this,"LthU",(function(e,r){n.MnXi[e]=n.MnXi[e]||{},n.MnXi[e]=t(t({},n.MnXi[e]),r)})),s(this,"getInstallationTime",(function(){return n.EBKC.getInstallationTime(n.startTime)})),s(this,"NjOA",(function(e){Ce.debug("Controller : Checking if the browsers localstorage is available."),Ze.waitForBrowserStorage(e)})),s(this,"hvMQ",(function(e,t,r,i){Ce.debug("Controller : Initializing the state variables"),n.window=i,n.startTime=t,n.siteId=e,n.clientConfig=r||{},n.initWaitTime=n.clientConfig.sdk_init_wait?1e3*n.clientConfig.sdk_init_wait:2e3,n._api=new He(n.siteId,n.window),n.EBKC=new $e(n.siteId),n.eBuu=new Re,n.whqq=new nt,n.orOO=je(n.startTime),n.sessionStartTime=parseInt(n.EBKC.lUOb("apx_sst",t)),Ce.debug("Controller : session start time is ".concat(n.sessionStartTime)),Ce.debug("Controller : SDK start time is ".concat(n.startTime)),n.sessionId=n.getFromStorage("_apx_sId")})),s(this,"myzW",(function(){Ce.debug("Controller : Initializing the LT Count ");try{var e=n.getFromStorage("_apx_lt_count");if(e)n.OoTk=JSON.parse((new TextDecoder).decode(pe(fe(n.siteId,e))));else{n.OoTk={};var t=ge(n.siteId,_e((new TextEncoder).encode(JSON.stringify(n.OoTk))));n.persistToStorage("_apx_lt_count",t)}}catch(e){Ce.error("Controller : LT Count object parsing failed ".concat(e))}})),s(this,"CSOi",(function(){var e=new URLSearchParams(location.search),t=e.get("_a")||e.get("_p")||e.get("_x")||e.get("_o")||e.get("_r");if(t||(t=n.getFromStorage("_apxor_url_param")),t)try{Ce.debug("Controller : Initialising in WYSIWYG mode");var r=fe(n.siteId,t),i=r=JSON.parse(r),o=i.app_id,s=i.expiry,a=Date.now();if(o===n.siteId&&a<=s){var u=new Date(s+6e4).toUTCString(),c=btoa("_apx_ew");document.cookie="_apx_ewc=".concat(c,"; expires=").concat(u),r.expiry=r.expiry+6e4,n.persistToStorage("_apx_ew",r,!0),Ce.debug("Controller : _apx_ewc cookie set")}e.delete("_a"),e.delete("_p"),e.delete("_x"),e.delete("_o"),e.delete("_r");var l=location.pathname,d=e.toString();""!==d&&(l+="?"+d),n.window.history.replaceState({},document.title,l),Ce.debug("Controller : Query params reset after removing dashboard embedded params")}catch(e){Ce.error("Controller : Error while setting the WYSIWYG cookie ".concat(e))}else Ce.debug("Controller : Not in WYSIWYG mode")})),s(this,"BhEP",(function(){Ce.debug("Controller : Setting the config");var e=n.EBKC.vaKi();n.srPU(e)})),s(this,"srPU",(function(e){n.config=t(t({},e),n.clientConfig),Ce.debug("Controller : New config and client configs Configs merged")})),s(this,"QYcY",(function(){var e,t,r,i=n.config,o=i.version,s=void 0===o?"":o,a=i.bulk_upload,u=void 0===a||a,c=i.events_upload_time,l=i.idle_time_out,d=void 0===l?1800:l,g=i.events,f=void 0===g?{}:g,h=i.max_chunk_event_count,v=void 0===h?20:h,p=i.retry_time,_=i.max_sessions_in_storage,m=void 0===_?-1:_;n.version=n.ctUP(s),n.cXEP=u,n.dVtK=c>0,n.VzVJ=j(d)?d:1800,n.vAjO=null!==(e=f.stop)&&void 0!==e?e:[],n.OTwG=null!==(t=f.action)&&void 0!==t?t:[],n.oKMw=null!==(r=f.app)&&void 0!==r?r:[],n.cqnr=R(v)&&j(v)?v:20,n.SeAP=R(c)&&j(c)&&c>=1e3?c:-1,n.ZOmf=R(p)&&j(p)&&p>=1e3?p:-1,n.vIFz=j(m)&&m>0?m:-1})),s(this,"ctUP",(function(e){var t;if(R(e))t=e,n.EBKC.Xgvu(t);else{var r=n.EBKC.HtJL();t=R(r)?r:""}return t})),s(this,"YKGx",(function(e,t){if(Ce.debug("Controller : Checking if the Site is enabled existing config"),!n.config.enable)return Ce.debug("Controller : Site is disabled. Can't initialise"),n.gVvJ(""),n.mIVZ(),void t();e()})),s(this,"Zkcq",(function(e,t){var r=n.EBKC.vaKi(),i=n.EBKC.lUOb("_apx_ledt",-1),o=r.ed_t_time;if(o>0&&i>0&&Math.abs(i-Date.now())<60*o*1e3)return Ce.debug("Controller : Reinitializing with in the throttling time."),n.EBKC.lUOb("_apx_lef",!0)?void e(n.EBKC.lUOb("_apx_ch","")):(Ce.debug("Controller : Site is not enabled from the last update. Can't initalise now. Recheck will happen after throttling time"),void t());n.Qyzc(e,t)})),s(this,"Qyzc",(function(e,t){Ce.debug("Controller : Getting the site enabled status from the server"),n.persistToStorage("_apx_ledt",Date.now()),n._api.ENPn((function(r){var i=r.enabled,o=r.hash;n.persistToStorage("_apx_lef",i),i?(Ce.debug("Controller : Site is enabled"),e(o)):(Ce.debug("Controller : Site is disabled. Can't initialise the SDK"),n.TSLA=!1,n.MHYs=!1,n.LSBV(),t())}),(function(e){Ce.error("Controller : enabled-status API failed ".concat(e))}))})),s(this,"LSBV",(function(){Ce.debug("Controller: Stopping the SDK");try{var e,t;n.MHYs=!1,n.TSLA=!1,n.zspv=!1,null===(e=n.eBuu)||void 0===e||e.jPdX(),null===(t=n.JRyM)||void 0===t||t.KcCt()}catch(e){Ce.error("Controller : Failed to stop the SDK ".concat(e))}})),s(this,"QvKk",(function(e,t){Ce.debug("Controller: Waiting ".concat(n.initWaitTime,"ms for all the resource loading to finish")),setTimeout((function(){t(e)}),n.initWaitTime)})),s(this,"fJhp",(function(){var e=n.EBKC.bQmJ();if(!R(e)){Ce.debug("Controller : Device id not found in localstorage");var t=n.config.client_id;R(t)&&""!==t?(Ce.debug("Controller : client id from clientconfig is the deviceid"),e=t):(Ce.debug("Controller : Generated a new device id. This is a new device now"),e=H()),n.mhTF(e)}return Ce.debug("Controller : Device id is ".concat(e)),n.Oshz=e,e})),s(this,"mhTF",(function(e){n.EBKC.vROQ(),n.EBKC.FJkB(e),n.EBKC.gaat(Date.now()),n.nyxV=t(t({},n.nyxV),{},{is_first_session:!0}),n.gYZO=!0})),s(this,"AhGg",(function(){Ce.debug("Controller : Setting the session state for session if ".concat(n.sessionId)),n.sessionId||(n.newSession=!0,n.sessionId=H(),n.persistToStorage("_apx_sId",n.sessionId),n.persistToStorage("apx_sst",n.sessionStartTime))})),s(this,"ReDR",(function(){var e=Z(n.window),t=e.device,r=e.os,i=e.browser_version,o=e.browser,s=e.dimensions,a=e.dpi,u=e.dimensions_in_pixels;n.fDid=function(e,t,n,r,i,o,s,a){return{id:e,hardware_model:t,dimensions:n,os_version:r,platform:"web",dpi:i,dimensions_in_pixels:o,browser:s,browser_version:a}}(n.Oshz,t,s,r,a,u,o,i)})),s(this,"PMAS",(function(){Ce.debug("Controller : Setting the default User attributes");var e=t({},n.fDid),r=$(n.window,e);n.CsTG=t(t({},n.CsTG),r)})),s(this,"ryzv",(function(){Ce.debug("Controller : Setting the default session attributes");var e=ee(n.window);n.ZvIV=t(t({},n.ZvIV),e)})),s(this,"gtcj",(function(){Ce.debug("Controller : Merging the stored and default user attributes");var e=n.getFromStorage("_apx_ua",!0);if(R(e)){var r,i=de(e);if(null===i)try{i=JSON.parse(fe(n.siteId,e))}catch(e){i={}}n.CsTG=t(t({},null!==(r=i)&&void 0!==r?r:{}),n.CsTG)}})),s(this,"nODQ",(function(){n.LnLo=t(t({},qe),{},{user_attributes:t({},n.CsTG),session_attributes:t({},n.ZvIV)}),n.EBKC.gBBO(n.LnLo)})),s(this,"qdfK",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};Ce.debug("Controller : Sending the old chunk to the server");var r=n.EBKC.hNKQ();if(R(r)){var i,o,s,a,u,c,l=t({},n.LnLo);if(n.LnLo=t({},r.chunk_details)||{},(null===(i=n.LnLo)||void 0===i||null===(i=i.app_events)||void 0===i?void 0:i.length)>0||n.SPpW(),!((null===(o=n.LnLo)||void 0===o||null===(o=o.app_events)||void 0===o?void 0:o.length)>0))return n.LnLo=t({},l),void e();var d=null!==(s=null===(a=r=t(t({},r),{},{chunk_details:t({},n.LnLo)}))||void 0===a||null===(a=a.session_info)||void 0===a?void 0:a.id)&&void 0!==s?s:"1",g=null!==(u=null===(c=r)||void 0===c||null===(c=c.chunk_meta)||void 0===c?void 0:c.number)&&void 0!==u?u:1;n.EBKC.CmLN(r),n._api.YZZd(r,(function(){n.JCOn(d,g+1),Ce.debug("Controller : Old chunk reporting successful."),n.EBKC.waYN(),n.EBKC.sjOv(),n.nODQ(),n.eiUW(),e()}),(function(){Ce.debug("Controller : Old chunk reporting failed."),e()}))}else e()})),s(this,"SPpW",(function(){var e=n.EBKC.LHHQ();if(R(e)){var t=e.app_events,r=e.navigation_events,i=e.system_events,o=e.user_events;n.LnLo.app_events=[].concat(u(n.LnLo.app_events||[]),u(t)),n.LnLo.navigation_events=[].concat(u(n.LnLo.navigation_events||[]),u(r)),n.LnLo.system_events=[].concat(u(n.LnLo.system_events||[]),u(i)),n.LnLo.user_events=[].concat(u(n.LnLo.user_events||[]),u(o)),n.EBKC.sjOv()}})),s(this,"JCOn",(function(e,t){var r=n.EBKC.QxSn();r[e]=t,n.EBKC.FtMl(r),n.GMjL=t})),s(this,"eiUW",(function(){var e=n.cqxf();return n.EBKC.CmLN(e),e})),s(this,"cqxf",(function(){var e=R(n.config.name)?n.config.name:"",r=R(n.config.domain)?n.config.domain:"",i=n.EBKC.TRXo(n.startTime,n.sessionStartTime,n.sessionId,n.VzVJ),o=i.chunk,s=o.session_info,a=o.app_info,u=o.sdk_info,c=o.chunk_details,l=o.chunk_meta,d=c.session_attributes,g=c.user_attributes;return n.nyxV=s,n.nyxV.is_first_session=n.gYZO,n.orOO=u,n.flnV=t(t({},a),{},{app_name:e,bundle_id:r,app_version:""+n.version}),n.GMjL=l.number,n.CsTG=t(t({},n.CsTG),g),n.ZvIV=t(t({},n.ZvIV),d),n.LnLo=c,n.SPpW(),n.newSession=i.is_new_session,n.newSession||n.hEGs(o),{sdk_info:n.orOO,session_info:n.nyxV,app_info:n.flnV,device_info:n.fDid,chunk_details:c,chunk_meta:l}})),s(this,"hEGs",(function(e){var t=e.session_info.id;t&&(n.sessionId=t,n.persistToStorage("_apx_sId",n.sessionId))})),s(this,"fTax",(function(){var e=n.nyxV,t=e.total_duration,r=e.duration;return t>r?t-r:0})),s(this,"gVvJ",(function(e){if(Ce.debug("Controller : Fetch a new config"),n.TYcc(e)){var t=n.config.sct_time,r=n.EBKC.lUOb("_apx_lct",-1);if(t>0&&r>0)if(Math.abs(Date.now()-r)<t)return void Ce.debug("Controller : No need to fetch config. Did not pass the throttle time");n.persistToStorage("_apx_lct",Date.now()),n._api.XDdn((function(e){var t;Ce.debug("Controller : New config fetched"),n.EBKC.cxjV(e),n.persistToStorage("_apx_ch",null!==(t=e.hash)&&void 0!==t?t:Me(e)),n.srPU(e),n.IHrU()}),(function(e){0!==e&&Ce.error("Controller : Failed to fetch config")}))}else Ce.debug("Controller : No need to fetch config. No change in hash")})),s(this,"mIVZ",(function(){Ce.debug("Controller : Posting user info");var e=n.orOO.sdk_version,t={sdk_version:JSON.stringify(e),app_info:n.flnV,device_info:n.fDid,user_attributes:n.CsTG},r=Me(t),i=n.EBKC.lUOb("_apx_uih","");r!==i?n._api.tRuf(t,(function(){Ce.debug("Controller : Posted user info. Persisting the hash to localstorage"),n.persistToStorage("_apx_uih",r)})):Ce.debug("Controller : No need to post user info. No change in it")})),s(this,"TYcc",(function(e){return""===e||n.EBKC.lUOb("_apx_ch","")!==e})),s(this,"OitU",(function(e){Ce.debug("Controller : Dispatching SYSTEM_EVENT");var t=Ue(e,n.getTimeElapsedInSession());n.dispatchEvent("SYSTEM_EVENT",t)})),s(this,"GbTM",(function(){Ce.debug("Controller : Resetting the session frequncy of all the campaigns to 0");var e={};try{var t=n.getFromStorage("qe_state");R(t)&&(e=JSON.parse(fe(n.siteId,t))),Object.entries(e).forEach((function(t){var n=a(t,1)[0];return e[n].SESSION=0}))}catch(t){e={},Ce.error("Controller : Can't reset campaign limits:".concat(t))}n.persistToStorage("qe_state",e,!0),n.window.ApxorRTM.resetFrequencyCounts()})),s(this,"FUlC",(function(){Ce.debug("Registering a handler for the system events"),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(null!=t&&J(t)){var n=e.document;"loading"!==n.readyState?t():J(n.addEventListener)?n.addEventListener("DOMContentLoaded",t):J(e.attachEvent)&&e.attachEvent("onreadystatechange",(function(e){"loading"!==n.readyState&&t(e)}))}}(n.window,(function(){n.saPj||(n.OVAf(),n.JRyM=new tt(!1),n.saPj=!0)}))})),s(this,"OVAf",(function(){var e=!1;!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return null};J(t)&&(e.addEventListener("pagehide",(function(e){return t(e),""})),e.addEventListener("beforeunload",(function(e){return t(e),""})),e.addEventListener("onunload",(function(e){return t(e),""})))}(window,(function(){(Ce.debug("Controller : Executing before unload"),e)||n.MHYs&&(e=!0,"visible"===window.document.visibilityState&&(n.KYEQ(!0),n.OitU("hidden")),clearInterval(n.TmaA),clearInterval(n.vJYe),n.cXEP&&n.EBKC.gBBO(n.LnLo),n.JRyM.KcCt())}))})),s(this,"Vgri",(function(){Ce.debug("Controller : Registering the handlers for chunk reporting"),clearInterval(n.vJYe),n.vJYe=setInterval((function(){n.Pcpf()}),n.HuHq),n.dVtK&&(clearInterval(n.TmaA),n.TmaA=setInterval((function(){n.vmEB()}),n.SeAP))})),s(this,"Pcpf",(function(){var e=n.LnLo,t=e.app_events,r=e.navigation_events;t.length+r.length>0&&!n.aoES&&n.MRXQ()})),s(this,"vmEB",(function(){var e=n.LnLo,t=e.app_events,r=e.navigation_events,i=t.length+r.length;(!n.cXEP&&i>0||n.cXEP&&i>=n.cqnr)&&n.MRXQ()})),s(this,"MRXQ",(function(){Ce.debug("Controller : Preparing and reporting chunk");var e=n.DyzT(n.LnLo);n.IkuY(e,!1)})),s(this,"DyzT",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Ce.debug("Controller : Preparing chunk"),n.KzKT();var r={id:n.sessionId+":"+n.GMjL,number:n.GMjL,reporting_times:[Date.now()]};return e=t(t({},e),{},{user_attributes:n.CsTG,session_attributes:n.ZvIV}),{sdk_info:n.orOO,session_info:n.nyxV,app_info:n.flnV,device_info:n.fDid,chunk_meta:r,chunk_details:e}})),s(this,"KzKT",(function(){Ce.debug("Controller : Updating the foreground time");var e=n.getSDKRunningTimeInSec(),r=e;e-=n.jpdV.NxnX(),n.nyxV=t(t({},n.nyxV),{},{duration:ie(e),total_duration:ie(r)})})),s(this,"IkuY",(function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};if(Ce.debug("Controller : Reporting chunk"),n.zspv||n.ZOmf>0&&-1!==n.DEse&&Date.now()-n.DEse<n.ZOmf)n.nODQ();else{var i=e.chunk_details,o=i.app_events,s=i.system_events,a=i.navigation_events,u=i.user_events;if(o.length<1&&s.length<1&&a.length<1&&u.length<1)return Ce.debug("Controller : Chunk not sent. No events in the chunk"),n.zspv=!1,void r();n.zspv=!0,n.JCOn(n.nyxV.id,n.GMjL+1),n.EBKC.sjOv(),n.EBKC.waYN(),n.nODQ(),t?(n.zspv=!1,n.EBKC.ntcu(e),r()):(n.EBKC.CmLN(e),n._api.YZZd(e,(function(){Ce.debug("Controller : Chunk successfully sent"),n.zspv=!1,n.DEse=-1,r()}),(function(t){Ce.debug("Controller : Chunk sending failed"),0!==t&&(n.zspv=!1,t>=500&&(n.DEse=Date.now()),413!==t&&417!==t&&n.EBKC.ntcu(e),r())})))}})),s(this,"setUserId",(function(e){n.TSLA?n.MHYs?V(e)||(Ce.debug("Controller : User id set"),n.setUserProperties({custom_user_id:e})):Ce.warn("Apxor SDK is not running"):it.setUserId()})),s(this,"setUserProperties",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n.TSLA)if(n.MHYs){if(Object.keys(e).length>0){n.CsTG=t(t({},n.CsTG),e);try{Ce.debug("Controller : User properties set"),n.persistToStorage("_apx_ua",ge(n.siteId,JSON.stringify(n.CsTG)))}catch(e){Ce.debug("Controller : Error while setting the use properties ".concat(e))}}}else Ce.warn("Apxor SDK is not running");else it.setUserProperties()})),s(this,"setSessionProperties",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n.TSLA?n.MHYs?Object.keys(e).length>0&&(Ce.debug("Controller : Session properties set"),n.ZvIV=t(t({},n.ZvIV),e)):Ce.warn("Apxor SDK is not running"):it.setSessionProperties()})),s(this,"setAppVersion",(function(e){n.TSLA?n.MHYs?n.version=e:Ce.warn("Apxor SDK is not running"):it.setAppVersion()})),s(this,"IHrU",(function(){Ce.debug("Controller : Updating the App info");var e=n.config,t=e.name,r=void 0===t?"":t,i=e.domain,o=void 0===i?n.window.location.host:i,s=n.EBKC.getInstallationTime(n.startTime),a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.location,n=void 0===t?{}:t,r=n.protocol,i=n.host,o=n.hostName;return"file:"===r||"localhost"===i||"0.0.0.0"===o||"127.0.0.1"===o?"development":"production"}(n.window),u=R(n.clientConfig.version)?""+n.clientConfig.version:n.EBKC.HtJL(),c=r;""===r&&"Unknown"===(c=ne(n.window))&&(c=""),n.flnV=function(e,t,n,r,i){return{app_name:e,app_version:i=R(i)?i:"ALL",bundle_id:t,installation_time:n,app_mode:r}}(c,o,s,a,u)})),s(this,"getEventCount",(function(e){var t=-1;return n.clientEvents.forEach((function(n){n.name===e&&(t+=1)})),-1===t?n.whqq.getEventCount(e):t})),s(this,"UOPq",(function(){n.KYEQ(),n.cZWk=null})),s(this,"KYEQ",(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Ce.debug("Controller : Ending the navigation"),R(n.cZWk)&&(n.cZWk.duration=ie(n.getSDKRunningTimeInSec()-n.cZWk.transition_time),n.dispatchEvent("NAVIGATION_EVENT",t({},n.cZWk),e))})),s(this,"getSessionId",(function(){return n.sessionId})),s(this,"QBiy",(function(){return n.TSLA?n.MHYs?n.Oshz:(Ce.warn("Controller : Apxor SDK is not running"),null):(it.getClientId(),null)})),s(this,"TRLL",(function(){var e;if(n.TSLA){var t=n.DyzT(n.LnLo),r=n.siteId,i=JSON.stringify(t);(null===(e=n.LnLo)||void 0===e?void 0:e.app_events.length)>0&&(Ce.debug("Reporting a chunk on visibility change with sendBeacon"),n.EBKC.sjOv(),n.EBKC.ntcu(t),navigator.sendBeacon("https://server.apxor.com/v2/api/".concat(r,"/text-chunks?appId=").concat(r),i))}})),s(this,"sOLS",(function(e){if(U(n.OoTk[e])&&0!==n.OoTk[e])n.OoTk[e]=0;else{var t=n.OoTk[e];t+=1,n.OoTk[e]=t}var r=ge(n.siteId,_e((new TextEncoder).encode(JSON.stringify(n.OoTk))));n.persistToStorage("_apx_lt_count",r)})),s(this,"WGuy",(function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!n.TSLA||!n.MHYs)return Ce.warn("Controller : Can't log App event. SDK not initialised"),void it.WGuy();try{if(Y(e)&&oe(r)){var s=e.replace("'","").replace("â€™","");n.sOLS(s);var a=n.OoTk[s]||0;r=t(t({},r),{},{apx_lt_count:a});var u=Je(e,se(r),i,n.getTimeElapsedInSession()),c="APP_EVENT";if(n.vAjO.includes(e))return;n.OTwG.includes(e)&&(c="CLIENT_EVENT"),Ce.debug("Controller : Logging event ".concat(e)),n.LthU(e,r),n.dispatchEvent(c,u,!1,o)}else Ce.debug("Controller : Invalid App Event ".concat(e))}catch(e){Ce.error("LT Count object parsing failed ".concat(e))}})),s(this,"logClientEvent",(function(e,r){if(!n.TSLA||!n.MHYs)return Ce.warn("Controller : Can't log client event. SDK not initialised"),void it.logClientEvent();var i=n.EBKC.getltCount(e);r=t(t({},r),{},{apx_lt_count:i});var o=Je(e,se(r),null,n.getTimeElapsedInSession()),s="CLIENT_EVENT";n.vAjO.includes(e)||(n.oKMw.includes(e)&&(s="APP_EVENT"),o?(Ce.debug("Controller : Logging client event ".concat(e)),n.LthU(e,r),n.dispatchEvent(s,o)):Ce.debug("Controller : Invalid client event ".concat(e)))})),s(this,"logPageView",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.getTimeElapsedInSession();if(!n.TSLA||!n.MHYs)return Ce.warn("Controller : Can't log page event. SDK not initialised"),void it.logPageView();if("string"==typeof e&&e&&e.length>0){var r=ie(t),i=Ye(e,ne(n.window),0,r);n.whqq.OfSJ(e),R(n.cZWk)?(n.KYEQ(),n.cZWk=i):n.cZWk=i,n.WGuy("APX_PAGE_OPENED",{time:z(new Date),navigation_id:e}),Ce.debug("logPageView: page view is logged ",e)}else Ce.warn("Controller : Can't log page event as pathname is empty")})),s(this,"dispatchEvent",(function(e,r){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Ce.debug("Controller : Dispatching Event ".concat(r.name)),n.EBKC.updateRetainedDayCount(Date.now());var s=!1,a=function(){var a=n.LnLo.app_events;switch(s&&(r.time=n.getTimeElapsedInSession()),e){case"APP_EVENT":n.LnLo=t(t({},n.LnLo),{},{app_events:[].concat(a,r)});break;case"CLIENT_EVENT":n.clientEvents.push(r)}if(n.eBuu.STjz(e,r),!s&&"CLIENT_EVENT"!==e){n.LnLo=t(t({},n.LnLo),{},{user_attributes:t({},n.CsTG),session_attributes:t({},n.ZvIV)});var u=n.DyzT(n.LnLo,e);if(n.EBKC.gBBO(n.LnLo),n.EBKC.ntcu(u),!0!==o)if(n.cXEP){if(a.length+1<n.cqnr)return;n.IkuY(u,i)}else i||"APP_EVENT"!==e||n.dVtK||n.IkuY(u,i);else n.IkuY(u,i)}},u=function(){n.persistToStorage("_apx_lEt",Date.now()),a()},c=function(){s=!0,n.startNewSession(Date.now(),u)};if("APP_EVENT"===e){var l=Date.now(),d=n.getFromStorage("_apx_lEt");d=Number(d),j(d)&&d>0&&Math.round(re(l-d))>n.VzVJ?n.endSession(!0,c):(n.persistToStorage("_apx_lEt",Date.now()),a())}else a()})),s(this,"startNewSession",(function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n.TSLA||i?(n.MHYs||(n.sessionId=H(),Ce.debug("Controller : New session started with id ".concat(n.sessionId)),n.persistToStorage("_apx_sId",n.sessionId),n.Lhgu=null!==(e=n.getFromStorage("apx_retained_session"))&&void 0!==e?e:0,n.Lhgu=Number(n.Lhgu)+1,n.persistToStorage("apx_retained_session",n.Lhgu),n.sessionStartTime=t,n.persistToStorage("apx_sst",n.sessionStartTime),n.jpdV.YolJ(),n.eiUW(),n.JRyM=new tt(n.config),n.MHYs=!0,n.GbTM()),r()):it.startSession()})),s(this,"endSession",(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};if(n.TSLA)if(n.MHYs){e||n.KYEQ();var i=t(t({},n.LnLo),{},{user_attributes:t({},n.CsTG),session_attributes:t({},n.ZvIV)}),o=n.DyzT(i);n.EBKC.sjOv();var s=function(){n.EBKC.xRVx(),n.jpdV.YolJ(),R(n.JRyM)&&n.saPj&&n.JRyM.KcCt(),F(document),n.MHYs=!1,r(),Ce.debug("Controller : Current session ended")};n.ZOmf>0&&n.DEse>0?(n.EBKC.ntcu(o),s()):n.IkuY(o,!1,s)}else Ce.warn("Apxor SDK is not running. Please make sure to call 'startSession'");else it.endSession()})),s(this,"resetUserProperties",(function(){n.EBKC.resetUserProperties();var e=$(n.window,n.getDevInfo());n.CsTG={},n.setUserProperties(e)})),s(this,"resetSessionProperties",(function(){var e=ee(n.window);n.ZvIV={},n.setSessionProperties(e)})),s(this,"persistToStorage",(function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=t;r&&oe(i)&&(i=ge(n.siteId,JSON.stringify(i))),n.EBKC.YFxR(e,i)})),s(this,"getFromStorage",(function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return n.EBKC.getItem(e,t)})),s(this,"XoEM",(function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n.EBKC.lUOb(e,t,r)})),s(this,"wlgU",(function(){return n.nyxV})),s(this,"getUserAttributes",(function(){return n.CsTG})),s(this,"getSessionAttributes",(function(){return n.ZvIV})),s(this,"makeGetRequest",(function(e,t,r){n._api.makeGetRequest(e,t,r)})),s(this,"fetchConfiguration",(function(e,t,r,i){n.whqq.fetchConfiguration(e,t,r,i)})),s(this,"flattenJSON",(function(e){return se(e,2)})),s(this,"registerForEvent",(function(e,t){n.eBuu.registerForEvent(e,t)})),s(this,"unregisterFromEvent",(function(e,t){n.eBuu.unregisterFromEvent(e,t)})),s(this,"getSDKRunningTimeInSec",(function(){return re(Date.now()-n.startTime)})),s(this,"getTimeElapsedInSession",(function(){var e=Date.now();return Ce.debug("Controller : Time elapsed in session is ".concat((e-n.sessionStartTime)/1e3,"sec")),re(e-n.sessionStartTime)})),s(this,"ZeSt",(function(e){n.aoES=e})),s(this,"persistTerminationInfoLocally",(function(e){null===n.getFromStorage("apx_termination_ID")&&n.persistToStorage("apx_termination_ID",JSON.stringify({}));var t=JSON.parse(n.getFromStorage("apx_termination_ID"));t[e]||(t[e]={startDate:"",_startTime:"",goalAcheived:!1}),n.persistToStorage("apx_termination_ID",JSON.stringify(t))})),s(this,"persistStartDateInfoLocally",(function(e){var t,r;null===n.getFromStorage("apx_termination_ID")&&n.persistToStorage("apx_termination_ID",JSON.stringify({}));var i=JSON.parse(n.getFromStorage("apx_termination_ID"));i[e]||(i[e]={startDate:Se(),_startTime:be(),goalAcheived:!1}),""===!(null!==(t=i[e])&&void 0!==t&&t.startDate)&&(i[e].startDate=Se()),""===!(null!==(r=i[e])&&void 0!==r&&r._startTime)&&(i[e]._startTime=be()),n.persistToStorage("apx_termination_ID",JSON.stringify(i))})),s(this,"isBadgeTriggerSatisfied",(function(e){var t,r;if(null===n.getFromStorage("apx_termination_ID"))return!1;var i=JSON.parse(n.getFromStorage("apx_termination_ID"));return!!i[e]&&(""!==!(null!==(t=i[e])&&void 0!==t&&t.startDate)||""!==!(null!==(r=i[e])&&void 0!==r&&r._startTime)||void 0)})),e.instance||(e.instance=this),e.instance}return o(e,null,[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();s(ot,"instance",void 0);var st=function(){function e(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:W();r(this,e),s(this,"TSLA",!1),s(this,"QYcX",[]),s(this,"version",232),s(this,"ycFk",!1),s(this,"WSkx",null),s(this,"BcTC",(function(){Array.isArray(n._q)&&n._q.forEach((function(e){var t=e.m,r=e.args;n[t]&&J(n[t])&&n[t].apply(n,Array.from(r))}))})),s(this,"init",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;try{if(Ce.debug("SDK : Apxor SDK initialization has started"),!n.TSLA){var o,s;R(t)&&(!R(t)||t instanceof Object)||(t=f);var a=t,u=a.honorDNT,c=void 0!==u&&u,l=a.debug,d=void 0!==l&&l,g=a.events_upload_time,h=void 0===g?-1:g,v=a.retry_time,p=void 0===v?-1:v,_=a.level,m=void 0===_?"error":_;if(null!==(o=n.window)&&void 0!==o&&null!==(o=o.localStorage)&&void 0!==o&&o.getItem("apx_debug_enable")&&(d="true"===n.window.localStorage.getItem("apx_debug_enable")),null!==(s=n.window)&&void 0!==s&&null!==(s=s.localStorage)&&void 0!==s&&s.getItem("apx_log_level")&&(m=n.window.localStorage.getItem("apx_log_level")),n.gpPK(d,m),!R(e)||!R(e.trim)||""===e.trim())return Ce.error("SDK : ApxorSDK couldn't be initialized: Invalid Site Id:".concat(e)),n._controller=it,void(null!=i&&J(i)&&i());if(c&&!te(n.window))return n._controller=it,null!=i&&J(i)&&i(),void Ce.error("SDK : Tracking is disabled, ApxorSDK couldn't be initialized");n._controller=ot.getInstance(),R(h)&&h>0&&(t.events_upload_time*=1e3),R(p)&&p>0&&(t.retry_time*=1e3),n._controller.initialize(e,n._startTime,t,n.window,(function(){n.TSLA=!0,n.QYcX.forEach((function(e){var t=e.m,r=e.args;n._controller[t].apply(n._controller,Array.from(r))})),null!=r&&J(r)&&(Ce.debug("SDK : Device id is "+n.getClientId()),r({client_id:n.getClientId(),session_id:n.getSessionId()})),n.window.console.info("ApxorSDK initialized for site:"+e+" with SDK version: 232")}),(function(){n.TSLA=!1,Ce.error("SDK : Failed to initialize Apxor SDK"),i&&J(i)&&i("")}))}}catch(e){n._controller.TSLA=!1,Ce.error("SDK : Exception while initializing Apxor SDK : ",e),i&&J(i)&&i(e)}})),s(this,"gpPK",(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error";Ce.enabled=e,Ce.level=t,Ce.console=n.window.console,Ce.debug("SDK : Logger configured with level ".concat(t))})),s(this,"setIsFlutter",(function(e){n.ycFk=e})),s(this,"isFlutter",(function(){return n.ycFk})),s(this,"registerApxorFlutterHelper",(function(e){n.WSkx=e})),s(this,"logEvent",(function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n.TSLA?n._controller.WGuy(e,t,void 0,r):n.QYcX.push({m:"WGuy",args:[e,t]})})),s(this,"logClientEvent",(function(e,t){n.TSLA?n._controller.logClientEvent(e,t):n.QYcX.push({m:"logClientEvent",args:[e,t]})})),s(this,"logPageView",(function(e){n.TSLA?n._controller.logPageView(e):n.QYcX.push({m:"logPageView",args:[e]})})),s(this,"setUserId",(function(e){n.TSLA?n._controller.setUserId(e):n.QYcX.push({m:"setUserId",args:[e]})})),s(this,"setUserProperties",(function(e){Ce.debug("SDK : User properties set"),n.TSLA?n._controller.setUserProperties(e):n.QYcX.push({m:"setUserProperties",args:[e]})})),s(this,"resetUserProperties",(function(){Ce.debug("SDK : User properties reset"),n.TSLA?n._controller.resetUserProperties():n.QYcX.push({m:"setUserProperties",args:[]})})),s(this,"resetSessionProperties",(function(){Ce.debug("SDK : User properties reset"),n.TSLA?n._controller.resetSessionProperties():n.QYcX.push({m:"setUserProperties",args:[]})})),s(this,"setSessionProperties",(function(e){Ce.debug("SDK : Session properties set"),n.TSLA?n._controller.setSessionProperties(e):n.QYcX.push({m:"setSessionProperties",args:[e]})})),s(this,"setAppVersion",(function(e){n.TSLA?n._controller.setAppVersion(e):n.QYcX.push({m:"setAppVersion",args:[e]})})),s(this,"flattenJSON",(function(e){n.TSLA?n._controller.flattenJSON(e):n.QYcX.push({m:"flattenJSON",args:[e]})})),s(this,"getSessionId",(function(){return n.TSLA?n._controller.getSessionId():null})),s(this,"getClientId",(function(){return n._controller.QBiy()})),s(this,"startNewSession",(function(){Ce.debug("SDK : A new session started"),n.TSLA?n._controller.startNewSession(Date.now()):n.QYcX.push({m:"startNewSession",args:[]})})),s(this,"endSession",(function(){Ce.debug("SDK : Current session ended"),n.TSLA?n._controller.endSession():n.QYcX.push({m:"endSession",args:[]})})),s(this,"getController",(function(){return n._controller})),s(this,"getSiteId",(function(){var e;return null===(e=n._controller)||void 0===e?void 0:e.getSiteId()})),s(this,"setRedirectionHandler",(function(e){J(e)?n.TSLA?n._controller.setRedirectionHandler(e):n.QYcX.push({m:"setRedirectionHandler",args:[e]}):Ce.error("Callback must be a function")})),s(this,"setInitFlag",(function(e){n.TSLA=e})),this.window=t,this._startTime=i,this.BcTC()}return o(e,[{key:"getApxorFlutterHelper",value:function(){return this.WSkx}}]),e}();window.Apxor=window.Apxor||{_q:[],_st:Date.now()},st.prototype._q=window.Apxor._q;var at=new st(window,+window.Apxor._st);window.Apxor=at,window.ApxorLogger=Ce;try{void 0===exports&&null===exports||(exports.default=at,module.exports=exports.default)}catch(e){}return at}));
